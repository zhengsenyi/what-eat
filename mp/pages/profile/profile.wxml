<view class="container-profile">
  <view class="main-card">
    <!-- 自定义导航栏 - 适配胶囊 -->
    <view class="custom-nav" style="padding-top: {{statusBarHeight}}px;">
      <view class="nav-content" style="height: {{navBarHeight}}px;">
        <view class="nav-left">
          <text class="page-title">我的</text>
        </view>
        <!-- 右侧区域 -->
        <view class="nav-right">
          <view class="nav-right-placeholder" style="width: {{menuButtonWidth}}px;"></view>
        </view>
      </view>
    </view>
    
    <scroll-view scroll-y class="content-scroll" enhanced="{{true}}" show-scrollbar="{{false}}">
      <!-- 用户信息卡片 -->
      <view class="user-card">
        <view class="user-info">
          <view class="avatar-wrapper">
            <view class="avatar-container">
              <text class="avatar-icon">{{userInfo.avatarText || '👤'}}</text>
            </view>
            <view class="avatar-badge">
              <text class="badge-icon">👑</text>
            </view>
          </view>
          <view class="user-details">
            <text class="user-name">{{userInfo.nickName || '美食探索家'}}</text>
            <view class="level-badge">
              <text class="level-icon">⭐</text>
              <text class="level-text">{{userInfo.level || '黄金会员'}}</text>
            </view>
          </view>
        </view>
        <view class="edit-btn" bindtap="editProfile">
          <text class="edit-text">编辑</text>
          <text class="edit-arrow">›</text>
        </view>
      </view>

      <!-- 今日剩余次数卡片 -->
      <view class="remaining-card">
        <view class="remaining-info">
          <text class="remaining-icon">🎁</text>
          <view class="remaining-text">
            <text class="remaining-label">今日剩余抽选次数</text>
            <text class="remaining-hint">每日0点重置</text>
          </view>
        </view>
        <view class="remaining-count">
          <text class="count-number">{{userInfo.remainingTimes || 0}}</text>
          <text class="count-unit">次</text>
        </view>
      </view>

      <!-- 功能菜单 -->
      <view class="menu-section">
        <text class="menu-section-title">常用功能</text>
        <view class="menu-card">
          <view class="menu-item" bindtap="goToHistory">
            <view class="menu-icon-wrapper history">
              <text class="menu-icon">🕒</text>
            </view>
            <view class="menu-content">
              <text class="menu-text">抽选历史</text>
              <text class="menu-desc">查看所有记录</text>
            </view>
            <text class="menu-arrow">›</text>
          </view>
        </view>
      </view>

      <!-- 系统菜单 -->
      <view class="menu-section">
        <text class="menu-section-title">更多</text>
        <view class="menu-card">
          <view class="menu-item" bindtap="goToFeedback">
            <view class="menu-icon-wrapper feedback">
              <text class="menu-icon">💬</text>
            </view>
            <view class="menu-content">
              <text class="menu-text">意见反馈</text>
              <text class="menu-desc">帮助我们改进</text>
            </view>
            <text class="menu-arrow">›</text>
          </view>
          <view class="menu-item" bindtap="goToAbout">
            <view class="menu-icon-wrapper about">
              <text class="menu-icon">ℹ️</text>
            </view>
            <view class="menu-content">
              <text class="menu-text">关于我们</text>
              <text class="menu-desc">版本 {{version}}</text>
            </view>
            <text class="menu-arrow">›</text>
          </view>
          <view class="menu-item" bindtap="clearCache">
            <view class="menu-icon-wrapper cache">
              <text class="menu-icon">🗑️</text>
            </view>
            <view class="menu-content">
              <text class="menu-text">清除缓存</text>
              <text class="menu-desc">{{cacheSize}}</text>
            </view>
            <text class="menu-arrow">›</text>
          </view>
        </view>
      </view>

      <!-- 退出登录按钮 -->
      <view class="logout-section">
        <button class="btn-logout" bindtap="logout">
          <text class="logout-icon">🚪</text>
          <text class="logout-text">退出登录</text>
        </button>
      </view>

      <!-- 底部版权信息 -->
      <view class="footer">
        <text class="footer-text">选餐侠 © 2024</text>
        <text class="footer-slogan">解决你的选择困难症</text>
      </view>

      <!-- 底部安全区域 -->
      <view class="safe-bottom"></view>
    </scroll-view>
  </view>
</view>
