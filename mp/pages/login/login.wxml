<view class="container-login">
  <!-- 背景装饰 -->
  <view class="bg-decoration">
    <view class="bg-circle bg-circle-1"></view>
    <view class="bg-circle bg-circle-2"></view>
  </view>
  
  <scroll-view class="login-scroll" scroll-y="true" enhanced="true" show-scrollbar="false">
    <view class="login-card fade-in">
      <view class="content">
        <!-- Logo和标题区域 -->
        <view class="header-section">
          <view class="logo-container">
            <image class="logo-image" src="../../static/logo.jpeg" mode="aspectFill" />
          </view>
          <text class="title">选餐侠</text>
          <text class="subtitle">解决你的选择困难症</text>
        </view>
        
        <!-- 微信登录按钮 -->
        <view class="wechat-login">
          <button
            class="btn-wechat"
            bindtap="onWechatLogin"
            disabled="{{isWechatLoading}}"
            hover-class="btn-wechat-hover"
          >
            <image class="wechat-icon" src="../../static/icons/wechat.png" mode="aspectFit" />
            <text class="btn-wechat-text">{{isWechatLoading ? '登录中...' : '微信一键登录'}}</text>
          </button>
        </view>
        
        <!-- 协议提示 -->
        <view class="agreement">
          <text class="agreement-text">登录即表示同意</text>
          <text class="agreement-link" bindtap="onViewAgreement">《用户协议》</text>
          <text class="agreement-text">和</text>
          <text class="agreement-link" bindtap="onViewPrivacy">《隐私政策》</text>
        </view>
      </view>
    </view>
  </scroll-view>

  <!-- 新用户信息授权弹窗 -->
  <view class="userinfo-modal" wx:if="{{showUserInfoModal}}">
    <view class="modal-mask"></view>
    <view class="modal-content">
      <view class="modal-header">
        <text class="modal-title">获取用户信息</text>
        <text class="modal-subtitle">授权后可获取您的微信头像和昵称</text>
      </view>
      
      <view class="modal-body">
        <!-- 头像和昵称获取区域 -->
        <view class="userinfo-form">
          <!-- 头像选择按钮 -->
          <view class="avatar-section">
            <!-- 使用 open-type="chooseAvatar" 获取微信头像 -->
            <button
              class="avatar-btn"
              open-type="chooseAvatar"
              bindchooseavatar="onChooseAvatar"
            >
              <image
                wx:if="{{tempAvatarUrl}}"
                class="avatar-preview"
                src="{{tempAvatarUrl}}"
                mode="aspectFill"
              />
              <view wx:else class="avatar-placeholder">
                <text class="avatar-placeholder-text">👤</text>
              </view>
              <view class="avatar-edit-icon">
                <text class="edit-icon-text">📷</text>
              </view>
            </button>
            <text class="avatar-hint">点击选择头像</text>
          </view>
          
          <!-- 昵称输入 -->
          <view class="nickname-section">
            <view class="nickname-input-wrapper">
              <text class="nickname-label">昵称</text>
              <input
                class="nickname-input"
                type="nickname"
                placeholder="请输入昵称"
                value="{{tempNickname}}"
                bindinput="onNicknameInput"
                bindblur="onNicknameBlur"
                bindconfirm="onNicknameConfirm"
              />
            </view>
          </view>
        </view>
        
        <!-- 提示信息 -->
        <view class="auth-tips">
          <text class="tips-text">💡 真机上点击头像和昵称可自动获取微信信息</text>
        </view>
      </view>
      
      <view class="modal-footer">
        <button class="btn-skip" bindtap="onSkipUserInfo">暂不设置</button>
        <button class="btn-confirm" bindtap="onConfirmUserInfo">完成注册</button>
      </view>
    </view>
  </view>

</view>
